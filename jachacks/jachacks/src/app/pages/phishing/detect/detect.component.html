<div>
  <h1 class="text-3xl text-center">Phishing Detector</h1>
  <button class="w-48 bg-amber-600 rounded mt-1 mb-4" (click)="switchMode()" [disabled]="phishingAnalyseState === PhishingAnalyseState.Analyzing">
    @if(mode === PhishingAnalyseMode.Manual) {
      Enter the information
    } @else {
      Upload a .eml file
    }
  </button>
  @if (mode === PhishingAnalyseMode.Manual) {
    <section class="flex flex-col mb-8">
      <label class="text-2xl">
        Sender
      </label>
      <div class="w-full h-8 flex flex-row">
        <app-input
          type="email"
          placeholder="Enter sender email here"
          (onTextChanged)="from = $event"
          class="w-full"
        />
      </div>
    </section>
    <section class="flex flex-col mb-8">
      <label class="text-2xl">
        Receiver
      </label>
      <div class="w-full h-8 flex flex-row">
        <app-input
          type="email"
          placeholder="Enter receiver email here"
          (onTextChanged)="to = $event"
          class="w-full"
        />
      </div>
    </section>
    <section class="flex flex-col mb-8">
      <label class="text-2xl">
        Subject
      </label>
      <div class="w-full h-8 flex flex-row">
        <app-input
          type="text"
          placeholder="Enter Subject"
          (onTextChanged)="subject = $event"
          class="w-full"
        />
      </div>
    </section>
    <section class="flex flex-col mb-8">
      <label class="text-2xl">
        Email
      </label>
      <div class="w-full flex flex-row">
        <app-input
          type="multiline"
          placeholder="Enter email content here"
          (onTextChanged)="body = $event"
          class="w-full"
        />
      </div>
    </section>
  }@else {
    <section class="flex flex-col mb-8">
      <label class="text-2xl">
        Upload a .eml file
      </label>
      <input #annoying type="file" [(ngModel)]="file" accept=".eml" />
    </section>
  }
  <div class="flex flex-row">
    <button (click)="detectPhishing()" class="w-full bg-amber-600 rounded mt-1 h-10" [disabled]="phishingAnalyseState === PhishingAnalyseState.Analyzing">
      Run the analysis
    </button>
  </div>

  @if(phishingAnalyseState == PhishingAnalyseState.Analyzed){
    <h1 class="text-3xl">Score: {{res?.score}}</h1>
    <h1 class="text-3xl">Reasoning:</h1>
    <div>
      @for(item of getResReasoning();track item){
        <div class="flex flex-row ">
          <br/>{{item}}
        </div>
      }
    </div>
  } @else if (phishingAnalyseState == PhishingAnalyseState.Analyzing){
    <div class="w-20 h-20 rounded-[50%] loader mx-auto mt-8">

    </div>
  }
  @if(fileError.length > 0){
    <div class="flex flex-row">
      <h1 class="text-3xl text-center">{{fileError}}</h1>
      <h1 class="text-1xl text-center">An error might indicate that the email is a scam and precautions should be taken.</h1>
    </div>
  }

</div>
